


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
    <title>Training your Pooch &mdash; Pooch v1.0.0</title>
    


  
  
    <link rel="shortcut icon" href="_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api/index.html" />
    <link rel="prev" title="Citing Pooch" href="citing.html" />
    <!-- Plausible analytics for anonymous usage statistics -->
    <script defer data-domain="fatiando.org" src="https://plausible.io/js/plausible.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/pooch-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing Pooch</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Training your Pooch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-problem">The problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="#assumptions">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hashes">Hashes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#versioning">Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#user-defined-paths">User-defined paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subdirectories">Subdirectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="#post-processing-hooks">Post-processing hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#downloaders-and-authentication">Downloaders and authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ftp-with-or-without-authentication">FTP with or without authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-downloaders">Custom downloaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="#printing-a-download-progress-bar">Printing a download progress bar</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adjusting-the-logging-level">Adjusting the logging level</a></li>
<li class="toctree-l2"><a class="reference internal" href="#so-you-have-1000-data-files">So you have 1000 data files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-registry-file">Creating a registry file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multiple-urls">Multiple URLs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Changelog</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Getting help and contributing
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://www.fatiando.org"><i class="fa fa-external-link-square fa-fw"></i> Fatiando a Terra</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/pooch/blob/master/CONTRIBUTING.md"><i class="fa fa-users fa-fw"></i> Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/pooch/blob/master/CODE_OF_CONDUCT.md"><i class="fa fa-gavel fa-fw"></i> Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="http://contact.fatiando.org"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/pooch"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pooch</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Training your Pooch</li>
    
    
    <li class="source-link">
        
            
                <a href="https://github.com/fatiando/pooch/edit/master/doc/usage.rst"
                   class="fa fa-github"> Improve this page</a>
            
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="training-your-pooch">
<span id="usage"></span><h1>Training your Pooch<a class="headerlink" href="#training-your-pooch" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-problem">
<h2>The problem<a class="headerlink" href="#the-problem" title="Permalink to this headline">¶</a></h2>
<p>You develop a Python library called <code class="docutils literal notranslate"><span class="pre">plumbus</span></code> for analysing data emitted by
interdimensional portals. You want to distribute sample data so that your users can
easily try out the library by copying and pasting from the docs. You want to have a
<code class="docutils literal notranslate"><span class="pre">plumbus.datasets</span></code> module that defines functions like <code class="docutils literal notranslate"><span class="pre">fetch_c137()</span></code> that will
return the data loaded as a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v0.25.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> for convenient access.</p>
</div>
<div class="section" id="assumptions">
<h2>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this headline">¶</a></h2>
<p>We’ll setup a <a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch" title="pooch.Pooch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pooch</span></code></a> to solve your data distribution needs.
In this example, we’ll work with the follow assumptions:</p>
<ol class="arabic simple">
<li><p>Your sample data are in a folder of your Github repository.</p></li>
<li><p>You use git tags to mark releases of your project in the history.</p></li>
<li><p>Your project has a variable that defines the version string.</p></li>
<li><p>The version string contains an indicator that the current commit is not a release
(like <code class="docutils literal notranslate"><span class="pre">'v1.2.3+12.d908jdl'</span></code> or <code class="docutils literal notranslate"><span class="pre">'v0.1+dev'</span></code>).</p></li>
</ol>
<p>Let’s say that this is the layout of your repository on Github:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>doc/
    ...
data/
    README.md
    c137.csv
    cronen.csv
plumbus/
    __init__.py
    ...
    datasets.py
setup.py
...
</pre></div>
</div>
<p>The sample data are stored in the <code class="docutils literal notranslate"><span class="pre">data</span></code> folder of your repository.</p>
</div>
<div class="section" id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>Pooch can download and cache your data files to the users’ computer automatically.
This is what the <code class="docutils literal notranslate"><span class="pre">plumbus/datasets.py</span></code> file would look like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Load sample data.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">pooch</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">version</span>  <span class="c1"># The version string of your project</span>


<span class="n">GOODBOY</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="c1"># Use the default cache folder for the OS</span>
    <span class="n">path</span><span class="o">=</span><span class="n">pooch</span><span class="o">.</span><span class="n">os_cache</span><span class="p">(</span><span class="s2">&quot;plumbus&quot;</span><span class="p">),</span>
    <span class="c1"># The remote data is on Github</span>
    <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;https://github.com/rick/plumbus/raw/</span><span class="si">{version}</span><span class="s2">/data/&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
    <span class="c1"># If this is a development version, get the data from the master branch</span>
    <span class="n">version_dev</span><span class="o">=</span><span class="s2">&quot;master&quot;</span><span class="p">,</span>
    <span class="c1"># The registry specifies the files that can be fetched from the local storage</span>
    <span class="n">registry</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;c137.csv&quot;</span><span class="p">:</span> <span class="s2">&quot;19uheidhlkjdwhoiwuhc0uhcwljchw9ochwochw89dcgw9dcgwc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cronen.csv&quot;</span><span class="p">:</span> <span class="s2">&quot;1upodh2ioduhw9celdjhlfvhksgdwikdgcowjhcwoduchowjg8w&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">fetch_c137</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the C-137 sample data as a pandas.DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The file will be downloaded automatically the first time this is run.</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;c137.csv&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>


<span class="k">def</span> <span class="nf">fetch_cronen</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the Cronenberg sample data as a pandas.DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;cronen.csv&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>When the user calls <code class="docutils literal notranslate"><span class="pre">plumbus.datasets.fetch_c137()</span></code> for the first time, the data file
will be downloaded and stored in the local storage. In this case, we’re using
<a class="reference internal" href="api/generated/pooch.os_cache.html#pooch.os_cache" title="pooch.os_cache"><code class="xref py py-func docutils literal notranslate"><span class="pre">pooch.os_cache</span></code></a> to set the local folder to the default cache location for your
OS. You could also provide any other path if you prefer. See the documentation for
<a class="reference internal" href="api/generated/pooch.create.html#pooch.create" title="pooch.create"><code class="xref py py-func docutils literal notranslate"><span class="pre">pooch.create</span></code></a> for more options.</p>
</div>
<div class="section" id="hashes">
<h2>Hashes<a class="headerlink" href="#hashes" title="Permalink to this headline">¶</a></h2>
<p>Pooch uses <a class="reference external" href="https://en.wikipedia.org/wiki/SHA-2">SHA256</a> hashes to check if files
are up-to-date or possibly corrupted:</p>
<ul class="simple">
<li><p>If a file exists in the local folder, Pooch will check that its hash matches the one
in the registry. If it doesn’t, we’ll assume that it needs to be updated.</p></li>
<li><p>If a file needs to be updated or doesn’t exist, Pooch will download it from the
remote source and check the hash. If the hash doesn’t match, an exception is raised to
warn of possible file corruption.</p></li>
</ul>
<p>You can generate hashes for your data files using the terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ openssl sha256 data/c137.csv
SHA256<span class="o">(</span>data/c137.csv<span class="o">)=</span> baee0894dba14b12085eacb204284b97e362f4f3e5a5807693cc90ef415c1b2d
</pre></div>
</div>
<p>Or using the <a class="reference internal" href="api/generated/pooch.file_hash.html#pooch.file_hash" title="pooch.file_hash"><code class="xref py py-func docutils literal notranslate"><span class="pre">pooch.file_hash</span></code></a> function (which is a convenient way of calling
Python’s <a class="reference external" href="https://docs.python.org/3/library/hashlib.html#module-hashlib" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hashlib</span></code></a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pooch</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pooch</span><span class="o">.</span><span class="n">file_hash</span><span class="p">(</span><span class="s2">&quot;data/c137.csv&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="versioning">
<h2>Versioning<a class="headerlink" href="#versioning" title="Permalink to this headline">¶</a></h2>
<p>The files from different version of your project will be kept in separate folders to
make sure they don’t conflict with each other. This way, you can safely update data
files while maintaining backward compatibility.
For example, if <code class="docutils literal notranslate"><span class="pre">path=&quot;.plumbus&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">version=&quot;v0.1&quot;</span></code>, the data folder will be
<code class="docutils literal notranslate"><span class="pre">.plumbus/v0.1</span></code>.</p>
<p>When your project updates, Pooch will automatically setup a separate folder for the new
data files based on the given version string. The remote URL will also be updated.
Notice that there is a format specifier <code class="docutils literal notranslate"><span class="pre">{version}</span></code> in the URL that Pooch substitutes
for you.</p>
<p>Versioning is optional and can be ignored by omitting the <code class="docutils literal notranslate"><span class="pre">version</span></code> and
<code class="docutils literal notranslate"><span class="pre">version_dev</span></code> arguments or setting them to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</div>
<div class="section" id="user-defined-paths">
<h2>User-defined paths<a class="headerlink" href="#user-defined-paths" title="Permalink to this headline">¶</a></h2>
<p>In the above example, the location of the local storage in the users’ computer is
hard-coded. There is no way for them to change it to something else. To avoid being a
tyrant, you can allow the user to define the <code class="docutils literal notranslate"><span class="pre">path</span></code> argument using an environment
variable:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">GOODBOY</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="c1"># This is still the default in case the environment variable isn&#39;t defined</span>
    <span class="n">path</span><span class="o">=</span><span class="n">pooch</span><span class="o">.</span><span class="n">os_cache</span><span class="p">(</span><span class="s2">&quot;plumbus&quot;</span><span class="p">),</span>
    <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;https://github.com/rick/plumbus/raw/</span><span class="si">{version}</span><span class="s2">/data/&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
    <span class="n">version_dev</span><span class="o">=</span><span class="s2">&quot;master&quot;</span><span class="p">,</span>
    <span class="n">registry</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;c137.csv&quot;</span><span class="p">:</span> <span class="s2">&quot;19uheidhlkjdwhoiwuhc0uhcwljchw9ochwochw89dcgw9dcgwc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cronen.csv&quot;</span><span class="p">:</span> <span class="s2">&quot;1upodh2ioduhw9celdjhlfvhksgdwikdgcowjhcwoduchowjg8w&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="c1"># The name of the environment variable that can overwrite the path argument</span>
    <span class="n">env</span><span class="o">=</span><span class="s2">&quot;PLUMBUS_DATA_DIR&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In this case, if the user defines the <code class="docutils literal notranslate"><span class="pre">PLUMBUS_DATA_DIR</span></code> environment variable, we’ll
use its value instead of <code class="docutils literal notranslate"><span class="pre">path</span></code>. Pooch will still append the value of <code class="docutils literal notranslate"><span class="pre">version</span></code> to
the path, so the value of <code class="docutils literal notranslate"><span class="pre">PLUMBUS_DATA_DIR</span></code> should not include a version number.</p>
</div>
<div class="section" id="subdirectories">
<h2>Subdirectories<a class="headerlink" href="#subdirectories" title="Permalink to this headline">¶</a></h2>
<p>You can have data files in subdirectories of the remote data store. These files will be
saved to the same subdirectories in the local storage folder. Note, however, that the
names of these files in the registry <strong>must use Unix-style separators</strong> (<code class="docutils literal notranslate"><span class="pre">'/'</span></code>) even
on Windows. We will handle the appropriate conversions.</p>
</div>
<div class="section" id="post-processing-hooks">
<h2>Post-processing hooks<a class="headerlink" href="#post-processing-hooks" title="Permalink to this headline">¶</a></h2>
<p>Sometimes further post-processing actions need to be taken on downloaded files
(unzipping, conversion to a more efficient format, etc). If these actions are time or
memory consuming, it would be best to do this only once when the file is actually
downloaded and not every time <a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch.fetch" title="pooch.Pooch.fetch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pooch.Pooch.fetch</span></code></a> is called.</p>
<p>One way to do this is using <em>post-processing hooks</em>. Method <a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch.fetch" title="pooch.Pooch.fetch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pooch.Pooch.fetch</span></code></a>
takes a <code class="docutils literal notranslate"><span class="pre">processor</span></code> argument that allows us to specify a function that is executed
post-download and before returning the local file path. The processor also lets us
overwrite the file name returned by <a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch.fetch" title="pooch.Pooch.fetch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pooch.Pooch.fetch</span></code></a>.</p>
<p>See the <a class="reference internal" href="api/index.html#api"><span class="std std-ref">API Reference</span></a> for a list of all available post-processing hooks.</p>
<p>For example, let’s say our data file is zipped and we want to store an unzipped copy of
it and read that instead. We can do this with a post-processing hook that unzips the
file and returns the path to the unzipped file instead of the original zip archive:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>


<span class="k">def</span> <span class="nf">unpack</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">pup</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Post-processing hook to unzip a file and return the unzipped file name.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fname : str</span>
<span class="sd">       Full path of the zipped file in local storage</span>
<span class="sd">    action : str</span>
<span class="sd">       One of &quot;download&quot; (file doesn&#39;t exist and will download),</span>
<span class="sd">       &quot;update&quot; (file is outdated and will download), and</span>
<span class="sd">       &quot;fetch&quot; (file exists and is updated so no download).</span>
<span class="sd">    pup : Pooch</span>
<span class="sd">       The instance of Pooch that called the processor function.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fname : str</span>
<span class="sd">       The full path to the unzipped file.</span>
<span class="sd">       (Return the same fname is your processor doesn&#39;t modify the file).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a new name for the unzipped file. Appending something to the name is a</span>
    <span class="c1"># relatively safe way of making sure there are no clashes with other files in</span>
    <span class="c1"># the registry.</span>
    <span class="n">unzipped</span> <span class="o">=</span> <span class="n">fname</span> <span class="o">+</span> <span class="s2">&quot;.unzipped&quot;</span>
    <span class="c1"># Don&#39;t unzip if file already exists and is not being downloaded</span>
    <span class="k">if</span> <span class="n">action</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;update&quot;</span><span class="p">,</span> <span class="s2">&quot;download&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">unzipped</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_file</span><span class="p">:</span>
            <span class="c1"># Extract the data file from within the archive</span>
            <span class="k">with</span> <span class="n">zip_file</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;actual-data-file.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">data_file</span><span class="p">:</span>
                <span class="c1"># Save it to our desired file name</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">unzipped</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output</span><span class="p">:</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="c1"># Return the path of the unzipped file</span>
    <span class="k">return</span> <span class="n">unzipped</span>


<span class="k">def</span> <span class="nf">fetch_zipped_file</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a large zipped sample data as a pandas.DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Pass in the processor to unzip the data file</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;zipped-data-file.zip&quot;</span><span class="p">,</span> <span class="n">processor</span><span class="o">=</span><span class="n">unpack</span><span class="p">)</span>
    <span class="c1"># fname is now the path of the unzipped file which can be loaded by pandas</span>
    <span class="c1"># directly</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Fortunately, you don’t have to implement your own unzip processor. Pooch provides the
<a class="reference internal" href="api/generated/pooch.Unzip.html#pooch.Unzip" title="pooch.Unzip"><code class="xref py py-class docutils literal notranslate"><span class="pre">pooch.Unzip</span></code></a> processor for exactly this use case. The above example using the
Pooch processor would look like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pooch</span> <span class="kn">import</span> <span class="n">Unzip</span>


<span class="k">def</span> <span class="nf">fetch_zipped_file</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a large zipped sample data as a pandas.DataFrame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract the file &quot;actual-data-file.txt&quot; from the archive</span>
    <span class="n">unpack</span> <span class="o">=</span>  <span class="n">Unzip</span><span class="p">(</span><span class="n">members</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;actual-data-file.txt&quot;</span><span class="p">])</span>
    <span class="c1"># Pass in the processor to unzip the data file</span>
    <span class="n">fnames</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;zipped-data-file.zip&quot;</span><span class="p">,</span> <span class="n">processor</span><span class="o">=</span><span class="n">unpack</span><span class="p">)</span>
    <span class="c1"># Returns the paths of all extract members (in our case, only one)</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># fname is now the path of the unzipped file (&quot;actual-data-file.txt&quot;) which can</span>
    <span class="c1"># be loaded by pandas directly</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>Alternatively, your zip archive could contain multiple files that you want to unpack. In
this case, the default behavior of <a class="reference internal" href="api/generated/pooch.Unzip.html#pooch.Unzip" title="pooch.Unzip"><code class="xref py py-class docutils literal notranslate"><span class="pre">pooch.Unzip</span></code></a> is to extract all files into a
directory and return a list of file paths instead of a single one:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fetch_zipped_archive</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load all files from a zipped archive.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Pass in the processor to unzip the data file</span>
    <span class="n">fnames</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;zipped-archive.zip&quot;</span><span class="p">,</span> <span class="n">processor</span><span class="o">=</span><span class="n">Unzip</span><span class="p">())</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">for</span> <span class="n">fname</span> <span class="ow">in</span> <span class="n">fnames</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>If you have a compressed file that is not an archive (zip or tar), you can use
<a class="reference internal" href="api/generated/pooch.Decompress.html#pooch.Decompress" title="pooch.Decompress"><code class="xref py py-class docutils literal notranslate"><span class="pre">pooch.Decompress</span></code></a> to decompress it after download. For example, large binary
files can be compressed with <code class="docutils literal notranslate"><span class="pre">gzip</span></code> to reduce download times but will need to be
decompressed before loading, which can be slow. You can trade storage space for speed by
keeping a decompressed copy of the file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pooch</span> <span class="kn">import</span> <span class="n">Decompress</span>

<span class="k">def</span> <span class="nf">fetch_compressed_file</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a large binary file that has been gzip compressed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Pass in the processor to decompress the file on download</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;large-binary-file.npy.gz&quot;</span><span class="p">,</span> <span class="n">processor</span><span class="o">=</span><span class="n">Decompress</span><span class="p">())</span>
    <span class="c1"># The file returned is the decompressed version which can be loaded by numpy</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="downloaders-and-authentication">
<h2>Downloaders and authentication<a class="headerlink" href="#downloaders-and-authentication" title="Permalink to this headline">¶</a></h2>
<p>By default, <a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch.fetch" title="pooch.Pooch.fetch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pooch.Pooch.fetch</span></code></a> will download files over HTTP without
authentication. Sometimes this is not enough: some servers require logins, some are FTP
instead of HTTP. To get around this, you can pass a <code class="docutils literal notranslate"><span class="pre">downloader</span></code> to
<a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch.fetch" title="pooch.Pooch.fetch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetch</span></code></a>.</p>
<p>Pooch provides <a class="reference internal" href="api/generated/pooch.HTTPDownloader.html#pooch.HTTPDownloader" title="pooch.HTTPDownloader"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTPDownloader</span></code></a> class (which is used by default) that can
be used to provide login credentials to HTTP servers that require authentication. For
example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pooch</span> <span class="kn">import</span> <span class="n">HTTPDownloader</span>


<span class="k">def</span> <span class="nf">fetch_protected_data</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch a file from a server that requires authentication</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Let the downloader know the login credentials</span>
    <span class="n">download_auth</span> <span class="o">=</span> <span class="n">HTTPDownloader</span><span class="p">(</span><span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;my_username&quot;</span><span class="p">,</span> <span class="s2">&quot;my_password&quot;</span><span class="p">))</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;some-data.csv&quot;</span><span class="p">,</span> <span class="n">downloader</span><span class="o">=</span><span class="n">download_auth</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>It’s probably not a good idea to hard-code credentials in your code. One way around this
is to ask users to set their own credentials through environment variables. The download
code could look something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>


<span class="k">def</span> <span class="nf">fetch_protected_data</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch a file from a server that requires authentication</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the credentials from the user&#39;s environment</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SOMESITE_USERNAME&quot;</span><span class="p">)</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SOMESITE_PASSWORD&quot;</span><span class="p">)</span>
    <span class="c1"># Let the downloader know the login credentials</span>
    <span class="n">download_auth</span> <span class="o">=</span> <span class="n">HTTPDownloader</span><span class="p">(</span><span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;some-data.csv&quot;</span><span class="p">,</span> <span class="n">downloader</span><span class="o">=</span><span class="n">download_auth</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="ftp-with-or-without-authentication">
<h2>FTP with or without authentication<a class="headerlink" href="#ftp-with-or-without-authentication" title="Permalink to this headline">¶</a></h2>
<p>Pooch also comes with the <a class="reference internal" href="api/generated/pooch.FTPDownloader.html#pooch.FTPDownloader" title="pooch.FTPDownloader"><code class="xref py py-class docutils literal notranslate"><span class="pre">FTPDownloader</span></code></a> class that can be used
when files are distributed over FTP. By default, <a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch.fetch" title="pooch.Pooch.fetch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pooch.Pooch.fetch</span></code></a> will
automatically detect if the download URL is HTTP(S) or FTP and use the appropriate
downloader:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">GOODBOY</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="n">pooch</span><span class="o">.</span><span class="n">os_cache</span><span class="p">(</span><span class="s2">&quot;plumbus&quot;</span><span class="p">),</span>
    <span class="c1"># Use an FTP server instead of HTTP. The rest is all the same.</span>
    <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;ftp://my-data-server.org/</span><span class="si">{version}</span><span class="s2">/&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
    <span class="n">version_dev</span><span class="o">=</span><span class="s2">&quot;master&quot;</span><span class="p">,</span>
    <span class="n">registry</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;c137.csv&quot;</span><span class="p">:</span> <span class="s2">&quot;19uheidhlkjdwhoiwuhc0uhcwljchw9ochwochw89dcgw9dcgwc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cronen.csv&quot;</span><span class="p">:</span> <span class="s2">&quot;1upodh2ioduhw9celdjhlfvhksgdwikdgcowjhcwoduchowjg8w&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">fetch_c137</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the C-137 sample data as a pandas.DataFrame (over FTP this time).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;c137.csv&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>However, sometimes the FTP server doesn’t support anonymous FTP and needs
authentication. In these cases, pass in an <a class="reference internal" href="api/generated/pooch.FTPDownloader.html#pooch.FTPDownloader" title="pooch.FTPDownloader"><code class="xref py py-class docutils literal notranslate"><span class="pre">FTPDownloader</span></code></a>
explicitly to <a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch.fetch" title="pooch.Pooch.fetch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pooch.Pooch.fetch</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>


<span class="k">def</span> <span class="nf">fetch_c137</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the C-137 sample data as a pandas.DataFrame (over FTP this time).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MYDATASERVER_USERNAME&quot;</span><span class="p">)</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MYDATASERVER_PASSWORD&quot;</span><span class="p">)</span>
    <span class="n">download_ftp</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">FTPDownloader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;c137.csv&quot;</span><span class="p">,</span> <span class="n">downloader</span><span class="o">=</span><span class="n">download_ftp</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-downloaders">
<h2>Custom downloaders<a class="headerlink" href="#custom-downloaders" title="Permalink to this headline">¶</a></h2>
<p>If your use case is not covered by our downloaders, you can implement your own. See
<a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch.fetch" title="pooch.Pooch.fetch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pooch.Pooch.fetch</span></code></a> for the required format of downloaders. As an example,
consider the case in which the login credentials need to be provided to a site that is
redirected from the original download URL in the <a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch" title="pooch.Pooch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pooch</span></code></a> registry:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>


<span class="k">def</span> <span class="nf">redirect_downloader</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">pooch</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Download after following a redirection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the credentials from the user&#39;s environment</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SOMESITE_USERNAME&quot;</span><span class="p">)</span>
    <span class="n">password</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SOMESITE_PASSWORD&quot;</span><span class="p">)</span>
    <span class="c1"># Make a request that will redirect to the login page</span>
    <span class="n">login</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="c1"># Provide the credentials and download from the new URL</span>
    <span class="n">download</span> <span class="o">=</span> <span class="n">HTTPDownloader</span><span class="p">(</span><span class="n">auth</span><span class="o">=</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span>
    <span class="n">download</span><span class="p">(</span><span class="n">login</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">mypooch</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">fetch_protected_data</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch a file from a server that requires authentication</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;some-data.csv&quot;</span><span class="p">,</span> <span class="n">downloader</span><span class="o">=</span><span class="n">redirect_downloader</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
<div class="section" id="printing-a-download-progress-bar">
<h2>Printing a download progress bar<a class="headerlink" href="#printing-a-download-progress-bar" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="api/generated/pooch.HTTPDownloader.html#pooch.HTTPDownloader" title="pooch.HTTPDownloader"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTPDownloader</span></code></a> can use <a class="reference external" href="https://github.com/tqdm/tqdm">tqdm</a> to
print a download progress bar. This is turned off by default but can be enabled using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pooch</span> <span class="kn">import</span> <span class="n">HTTPDownloader</span>


<span class="k">def</span> <span class="nf">fetch_large_data</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fetch a large file from a server and print a progress bar.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">download</span> <span class="o">=</span> <span class="n">HTTPDownloader</span><span class="p">(</span><span class="n">progressbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">GOODBOY</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;large-data-file.h5&quot;</span><span class="p">,</span> <span class="n">downloader</span><span class="o">=</span><span class="n">download</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
<p>The resulting progress bar will be printed to stderr and should look something like
this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>100%|█████████████████████████████████████████| 336/336 [...]
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">tqdm</span></code> is not installed by default with Pooch. You will have to install it
separately in order to use this feature.</p>
</div>
</div>
<div class="section" id="adjusting-the-logging-level">
<h2>Adjusting the logging level<a class="headerlink" href="#adjusting-the-logging-level" title="Permalink to this headline">¶</a></h2>
<p>Pooch will log events like downloading a new file, updating an existing one, or
unpacking an archive by printing to the terminal. You can change how verbose these
events are by getting the event logger from pooch and changing the logging level:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">get_logger</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Most of the events from Pooch are logged at the info level; this code says that you only
care about warnings or errors, like inability to create the data cache. The event logger
is a <a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Logger</span></code></a> object, so you can use that class’s methods to handle
logging events in more sophisticated ways if you wish.</p>
</div>
<div class="section" id="so-you-have-1000-data-files">
<h2>So you have 1000 data files<a class="headerlink" href="#so-you-have-1000-data-files" title="Permalink to this headline">¶</a></h2>
<p>If your project has a large number of data files, it can be tedious to list them in a
dictionary. In these cases, it’s better to store the file names and hashes in a file and
use <a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch.load_registry" title="pooch.Pooch.load_registry"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pooch.Pooch.load_registry</span></code></a> to read them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pkg_resources</span>

<span class="n">GOODBOY</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="c1"># Use the default cache folder for the OS</span>
    <span class="n">path</span><span class="o">=</span><span class="n">pooch</span><span class="o">.</span><span class="n">os_cache</span><span class="p">(</span><span class="s2">&quot;plumbus&quot;</span><span class="p">),</span>
    <span class="c1"># The remote data is on Github</span>
    <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;https://github.com/rick/plumbus/raw/</span><span class="si">{version}</span><span class="s2">/data/&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
    <span class="c1"># If this is a development version, get the data from the master branch</span>
    <span class="n">version_dev</span><span class="o">=</span><span class="s2">&quot;master&quot;</span><span class="p">,</span>
    <span class="c1"># We&#39;ll load it from a file later</span>
    <span class="n">registry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Get registry file from package_data</span>
<span class="n">registry_file</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_stream</span><span class="p">(</span><span class="s2">&quot;plumbus&quot;</span><span class="p">,</span> <span class="s2">&quot;registry.txt&quot;</span><span class="p">)</span>
<span class="c1"># Load this registry file</span>
<span class="n">GOODBOY</span><span class="o">.</span><span class="n">load_registry</span><span class="p">(</span><span class="n">registry_file</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">registry.txt</span></code> file is in the <code class="docutils literal notranslate"><span class="pre">plumbus/</span></code> package directory and should be
shipped with the package (see below for instructions).
We use <a class="reference external" href="https://setuptools.readthedocs.io/en/latest/pkg_resources.html#basic-resource-access">pkg_resources</a>
to access the <code class="docutils literal notranslate"><span class="pre">registry.txt</span></code>, giving it the name of our Python package.</p>
<p>The contents of <code class="docutils literal notranslate"><span class="pre">registry.txt</span></code> are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>c137.csv 19uheidhlkjdwhoiwuhc0uhcwljchw9ochwochw89dcgw9dcgwc
cronen.csv 1upodh2ioduhw9celdjhlfvhksgdwikdgcowjhcwoduchowjg8w
</pre></div>
</div>
<p>To make sure the registry file is shipped with your package, include the following in
your <code class="docutils literal notranslate"><span class="pre">MANIFEST.in</span></code> file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>include plumbus/registry.txt
</pre></div>
</div>
<p>And the following entry in the <code class="docutils literal notranslate"><span class="pre">setup</span></code> function of your <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">setup</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">package_data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;plumbus&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;registry.txt&quot;</span><span class="p">]},</span>
    <span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-a-registry-file">
<h2>Creating a registry file<a class="headerlink" href="#creating-a-registry-file" title="Permalink to this headline">¶</a></h2>
<p>If you have many data files, creating the registry and keeping it updated can be a
challenge. Function <a class="reference internal" href="api/generated/pooch.make_registry.html#pooch.make_registry" title="pooch.make_registry"><code class="xref py py-func docutils literal notranslate"><span class="pre">pooch.make_registry</span></code></a> will create a registry file with all
contents of a directory. For example, we can generate the registry file for our
fictitious project from the command-line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python -c <span class="s2">&quot;import pooch; pooch.make_registry(&#39;data&#39;, &#39;plumbus/registry.txt&#39;)&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="multiple-urls">
<h2>Multiple URLs<a class="headerlink" href="#multiple-urls" title="Permalink to this headline">¶</a></h2>
<p>You can set a custom download URL for individual files with the <code class="docutils literal notranslate"><span class="pre">urls</span></code> argument of
<a class="reference internal" href="api/generated/pooch.create.html#pooch.create" title="pooch.create"><code class="xref py py-func docutils literal notranslate"><span class="pre">pooch.create</span></code></a> or <a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch" title="pooch.Pooch"><code class="xref py py-class docutils literal notranslate"><span class="pre">pooch.Pooch</span></code></a>. It should be a dictionary with the file
names as keys and the URLs for downloading the files as values. For example, say we have
a <code class="docutils literal notranslate"><span class="pre">citadel.csv</span></code> file that we want to download from
<code class="docutils literal notranslate"><span class="pre">https://www.some-data-hosting-site.com</span></code> instead:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The basic setup is the same and we must include citadel.csv in the registry.</span>
<span class="n">GOODBOY</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="n">pooch</span><span class="o">.</span><span class="n">os_cache</span><span class="p">(</span><span class="s2">&quot;plumbus&quot;</span><span class="p">),</span>
    <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;https://github.com/rick/plumbus/raw/</span><span class="si">{version}</span><span class="s2">/data/&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
    <span class="n">version_dev</span><span class="o">=</span><span class="s2">&quot;master&quot;</span><span class="p">,</span>
    <span class="n">registry</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;c137.csv&quot;</span><span class="p">:</span> <span class="s2">&quot;19uheidhlkjdwhoiwuhc0uhcwljchw9ochwochw89dcgw9dcgwc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cronen.csv&quot;</span><span class="p">:</span> <span class="s2">&quot;1upodh2ioduhw9celdjhlfvhksgdwikdgcowjhcwoduchowjg8w&quot;</span><span class="p">,</span>
        <span class="s2">&quot;citadel.csv&quot;</span><span class="p">:</span> <span class="s2">&quot;893yprofwjndcwhx9c0ehp3ue9gcwoscjwdfgh923e0hwhcwiyc&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="c1"># Now specify custom URLs for some of the files in the registry.</span>
    <span class="n">urls</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;citadel.csv&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.some-data-hosting-site.com/files/citadel.csv&quot;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Notice that versioning of custom URLs is not supported (since they are assumed to be
data files independent of your project) and the file name will not be appended
automatically to the URL (in case you want to change the file name in local storage).</p>
<p>Custom URLs can be used along side <code class="docutils literal notranslate"><span class="pre">base_url</span></code> or you can omit <code class="docutils literal notranslate"><span class="pre">base_url</span></code> entirely by
setting it to an empty string (<code class="docutils literal notranslate"><span class="pre">base_url=&quot;&quot;</span></code>). However, doing so requires setting a
custom URL for every file in the registry.</p>
<p>You can also include custom URLs in a registry file by adding the URL for a file to end
of the line (separated by a space):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>c137.csv 19uheidhlkjdwhoiwuhc0uhcwljchw9ochwochw89dcgw9dcgwc
cronen.csv 1upodh2ioduhw9celdjhlfvhksgdwikdgcowjhcwoduchowjg8w
citadel.csv 893yprofwjndcwhx9c0ehp3ue9gcwoscjwdfgh923e0hwhcwiyc https://www.some-data-hosting-site.com/files/citadel.csv
</pre></div>
</div>
<p><a class="reference internal" href="api/generated/pooch.Pooch.html#pooch.Pooch.load_registry" title="pooch.Pooch.load_registry"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pooch.Pooch.load_registry</span></code></a> will automatically populate the <code class="docutils literal notranslate"><span class="pre">urls</span></code> attribute.
This way, custom URLs don’t need to be set in the code. In fact, the module code doesn’t
change at all:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the Pooch exactly the same (urls is None by default)</span>
<span class="n">GOODBOY</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="n">pooch</span><span class="o">.</span><span class="n">os_cache</span><span class="p">(</span><span class="s2">&quot;plumbus&quot;</span><span class="p">),</span>
    <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;https://github.com/rick/plumbus/raw/</span><span class="si">{version}</span><span class="s2">/data/&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">,</span>
    <span class="n">version_dev</span><span class="o">=</span><span class="s2">&quot;master&quot;</span><span class="p">,</span>
    <span class="n">registry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># If custom URLs are present in the registry file, they will be set automatically</span>
<span class="n">GOODBOY</span><span class="o">.</span><span class="n">load_registry</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;registry.txt&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api/index.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="citing.html" class="btn btn-neutral float-left" title="Citing Pooch" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2020, The Pooch Developers
      <span class="lastupdated">
        Last updated on Jan 28, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>